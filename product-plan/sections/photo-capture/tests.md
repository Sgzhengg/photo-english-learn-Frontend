# Test Instructions: Photo Capture (拍照识别)

这些测试说明**与框架无关**。请适应到您的测试设置。

## 概述

拍照识别功能允许用户拍照、识别图片中的单词、保存到生词库，并查看AI生成的场景描述句子。

---

## 用户流程测试

### 流程 1: 拍照并识别单词

**场景:** 用户拍摄照片并保存识别出的单词

#### 成功路径

**步骤:**
1. 用户进入拍照页面（底部导航中央按钮）
2. 用户看到相机取景器界面
3. 用户点击拍照按钮
4. 显示识别中状态（加载动画）
5. AI 识别完成后，显示识别结果页面
6. 页面显示识别出的单词列表（3-5个单词卡片）
7. 每个单词卡片显示：英文单词、中文释义、音标、发音按钮、保存按钮
8. 用户点击某个单词的"保存"按钮
9. 按钮变为"已保存"状态

**预期结果:**
- [ ] 单词保存到用户的生词库
- [ ] 保存按钮变为高亮状态或显示"已保存"文字
- [ ] 保存的单词数据持久化
- [ ] 页面下方显示场景描述句子

#### 失败路径: 识别失败

**前置条件:**
- 照片模糊或无法识别

**预期结果:**
- [ ] 显示友好错误提示："无法识别图片中的文字，请重试"
- [ ] 提供"重新拍照"按钮
- [ ] 不显示单词列表

---

### 流程 2: 播放场景描述句子

**场景:** 用户播放AI生成的场景句子TTS

**步骤:**
1. 用户已保存至少一个单词
2. 场景描述句子显示在结果页面下方
3. 用户点击"播放句子"按钮
4. TTS 开始朗读英文句子
5. 朗读过程中，当前读到的单词在句子中高亮显示
6. 朗读进度跟随语音

**预期结果:**
- [ ] TTS 音频播放正常
- [ ] 按钮状态变为"暂停"或"停止"
- [ ] 当前单词高亮（背景色变化或文字颜色变化）
- [ ] 高亮位置随语音进度同步更新
- [ ] 播放完成后，按钮恢复为"播放"状态

---

### 流程 3: 播放单词发音

**场景:** 用户播放单个单词的发音

**步骤:**
1. 用户在单词卡片上点击发音按钮（喇叭图标）
2. TTS 播放该单词的发音

**预期结果:**
- [ ] 单词发音播放
- [ ] 按钮在播放时显示播放动画或状态
- [ ] 多个单词可以依次播放，不会冲突

---

## 空状态测试

### 首次使用 - 未拍照

**场景:** 用户首次进入拍照页面

**预期结果:**
- [ ] 显示相机取景器界面
- [ ] 显示拍照引导："拍照识别英语单词"
- [ ] 拍照按钮居中突出显示

### 拍照后无识别结果

**场景:** 拍照成功但未识别到任何单词

**预期结果:**
- [ ] 显示空状态消息："未识别到英文单词"
- [ ] 显示建议提示："请拍摄包含英文的图片"
- [ ] 提供"重新拍照"按钮

---

## 组件交互测试

### PhotoCaptureResult

**渲染正确:**
- [ ] 显示拍摄的图片预览
- [ ] 显示单词卡片列表
- [ ] 显示场景描述句子区域
- [ ] 每个单词包含完整信息

**用户交互:**
- [ ] 点击"保存"按钮调用 `onSaveWord` 回调并传递 wordId
- [ ] 点击"取消保存"按钮调用 `onUnsaveWord` 回调
- [ ] 点击单词发音按钮调用 `onPlayWordPronunciation` 回调
- [ ] 点击"播放句子"按钮调用 `onPlayScene` 回调
- [ ] 点击"暂停"按钮调用 `onPauseScene` 回调

**TTS 进度高亮:**
- [ ] 根据 `currentWordIndex` 正确高亮对应单词
- [ ] 高亮样式明显（背景色或文字色变化）
- [ ] 高亮位置随索引更新平滑过渡

---

### WordCard

**渲染正确:**
- [ ] 显示英文单词
- [ ] 显示中文释义
- [ ] 显示音标（使用 monospace 字体）
- [ ] 显示发音播放按钮
- [ ] 显示保存按钮
- [ ] 如果 `isSaved: true`，按钮显示"已保存"状态

**用户交互:**
- [ ] 点击发音按钮播放单词发音
- [ ] 点击保存按钮切换保存状态
- [ ] 已保存状态有明显的视觉区分（颜色、图标或文字）

---

### SceneSentence

**渲染正确:**
- [ ] 显示英文场景句子
- [ ] 显示中文翻译
- [ ] 显示播放/暂停按钮
- [ ] 句子中的单词可被高亮

**TTS 高亮:**
- [ ] 根据 `currentWordIndex` 高亮对应单词
- [ ] 未高亮的单词使用普通样式
- [ ] 高亮样式醒目但不影响可读性

**用户交互:**
- [ ] 点击播放按钮开始朗读
- [ ] 点击暂停按钮停止朗读
- [ ] 播放状态正确切换

---

## 边界情况

- [ ] 处理网络超时（OCR识别超时）
- [ ] 处理非常大的图片文件
- [ ] 处理识别结果超过10个单词
- [ ] 处理识别结果为0个单词
- [ ] 处理TTS播放失败（网络错误）
- [ ] 处理多次快速点击保存按钮
- [ ] 处理重复单词的保存

---

## 数据断言

```typescript
// 单词卡片数据
const mockWord = {
  id: 'word-001',
  word: 'serendipity',
  phonetic: '/ˌserənˈdɪpəti/',
  definition: '意外发现珍奇事物的本领',
  pronunciationUrl: 'https://example.com/audio/serendipity.mp3',
  isSaved: false,
  positionInSentence: 2
};

// 拍照结果数据
const mockPhoto = {
  id: 'photo-001',
  imageUrl: 'https://example.com/photo.jpg',
  thumbnailUrl: 'https://example.com/photo-thumb.jpg',
  capturedAt: '2025-01-28T10:30:00Z',
  location: '上海',
  status: 'completed',
  recognizedWords: [mockWord, /* ... */],
  sceneDescription: 'A peaceful park with beautiful flowers',
  sceneTranslation: '一个宁静的公园，有美丽的花朵'
};
```

---

## 注意事项

- Mock OCR API 响应测试不同场景（成功、失败、空结果）
- 测试 TTS 高亮位置的计算逻辑
- 验证保存状态在API调用前后的乐观更新
- 测试从空到有数据：首次拍照后的UI变化
- 确保所有音频播放可以正常中断和重启
